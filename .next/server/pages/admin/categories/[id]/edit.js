"use strict";(()=>{var e={};e.id=141,e.ids=[141,888,660],e.modules={7923:(e,t,a)=>{a.a(e,async(e,s)=>{try{a.r(t),a.d(t,{config:()=>x,default:()=>m,getServerSideProps:()=>g,getStaticPaths:()=>h,getStaticProps:()=>u,reportWebVitals:()=>y,routeModule:()=>C,unstable_getServerProps:()=>_,unstable_getServerSideProps:()=>b,unstable_getStaticParams:()=>f,unstable_getStaticPaths:()=>v,unstable_getStaticProps:()=>j});var i=a(7093),r=a(5244),n=a(1323),l=a(9209),d=a.n(l),o=a(9597),c=a(2891),p=e([o,c]);[o,c]=p.then?(await p)():p;let m=(0,n.l)(c,"default"),u=(0,n.l)(c,"getStaticProps"),h=(0,n.l)(c,"getStaticPaths"),g=(0,n.l)(c,"getServerSideProps"),x=(0,n.l)(c,"config"),y=(0,n.l)(c,"reportWebVitals"),j=(0,n.l)(c,"unstable_getStaticProps"),v=(0,n.l)(c,"unstable_getStaticPaths"),f=(0,n.l)(c,"unstable_getStaticParams"),_=(0,n.l)(c,"unstable_getServerProps"),b=(0,n.l)(c,"unstable_getServerSideProps"),C=new i.PagesRouteModule({definition:{kind:r.x.PAGES,page:"/admin/categories/[id]/edit",pathname:"/admin/categories/[id]/edit",bundlePath:"",filename:""},components:{App:o.default,Document:d()},userland:c});s()}catch(e){s(e)}})},2891:(e,t,a)=>{a.a(e,async(e,s)=>{try{a.r(t),a.d(t,{default:()=>EditCategory});var i=a(997),r=a(1163),n=a(5941),l=a(1842),d=a(3142),o=a(6689),c=a(3590),p=a(1664),m=a.n(p),u=e([n,l,d,c]);[n,l,d,c]=u.then?(await u)():u;let fetcher=e=>l.Z.get(e);function EditCategory(){let e=(0,r.useRouter)(),{id:t}=e.query,{data:a,error:s,mutate:p}=(0,n.default)(t?`/categories/${t}`:null,fetcher),[u,h]=(0,o.useState)(null),[g,x]=(0,o.useState)(null),[y,j]=(0,o.useState)([]),[v,f]=(0,o.useState)(!1);function handleChange(e){let{name:t,value:a,type:s,checked:i}=e.target;h(e=>({...e,[t]:"checkbox"===s?i:a}))}function handleThumb(e){x(e.target.files[0]||null)}function handleImages(e){j(Array.from(e.target.files))}async function handleSubmit(t){if(t.preventDefault(),!u||!u.name){c.toast.error("Name required");return}f(!0);try{let t=new FormData;t.append("name",u.name),u.slug&&t.append("slug",u.slug),t.append("description",u.description),t.append("display_type",u.display_type),u.parent&&t.append("parent",u.parent),t.append("meta_title",u.meta_title),t.append("meta_description",u.meta_description),t.append("meta_keywords",u.meta_keywords||""),t.append("isActive",u.isActive?"true":"false"),g&&t.append("image",g),y.forEach(e=>t.append("image",e));let a=await l.Z.put(`/categories/${u._id}`,t,{headers:{"Content-Type":"multipart/form-data"}}),s=a?.data??a;s?.success?(c.toast.success("Category updated"),p(),e.push("/admin/categories")):c.toast.error(s?.message||"Update failed")}catch(e){c.toast.error(e?.response?.data?.message||e.message||"Error")}finally{f(!1)}}return((0,o.useEffect)(()=>{if(!a)return;let e=a?.data||a?.category||a;h({name:e.name||"",slug:e.slug||"",description:e.description||"",display_type:e.display_type||"default",parent:e.parent||"",meta_title:e.meta_title||"",meta_description:e.meta_description||"",meta_keywords:Array.isArray(e.meta_keywords)?e.meta_keywords.join(", "):e.meta_keywords||"",isActive:"boolean"!=typeof e.isActive||e.isActive,_id:e._id||e.id,images_existing:e.images||[],thumbnail_existing:e.thumbnail||""})},[a]),s)?i.jsx(d.Z,{title:"Edit Category",children:i.jsx("div",{className:"card",children:"❌ Error loading category"})}):u?(0,i.jsxs)(d.Z,{title:`Edit Category: ${u.name}`,children:[(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[i.jsx("h2",{children:"Edit Category"}),i.jsx("div",{style:{display:"flex",gap:8},children:i.jsx(m(),{href:"/admin/products/category",legacyBehavior:!0,children:i.jsx("a",{className:"btn ghost",children:"Back"})})})]}),i.jsx("form",{onSubmit:handleSubmit,children:i.jsx("div",{className:"card",style:{padding:20},children:(0,i.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 300px",gap:20},children:[(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{className:"form-row",children:[i.jsx("label",{children:"Name"}),i.jsx("input",{name:"name",value:u.name,onChange:handleChange,required:!0})]}),(0,i.jsxs)("div",{className:"form-row",children:[i.jsx("label",{children:"Slug"}),i.jsx("input",{name:"slug",value:u.slug,onChange:handleChange})]}),(0,i.jsxs)("div",{className:"form-row",children:[i.jsx("label",{children:"Description"}),i.jsx("textarea",{name:"description",value:u.description,onChange:handleChange,rows:"3"})]}),(0,i.jsxs)("div",{className:"form-row",children:[i.jsx("label",{children:"Parent (ID)"}),i.jsx("input",{name:"parent",value:u.parent,onChange:handleChange})]}),(0,i.jsxs)("div",{className:"form-row",children:[i.jsx("label",{children:"Display type"}),(0,i.jsxs)("select",{name:"display_type",value:u.display_type,onChange:handleChange,children:[i.jsx("option",{value:"default",children:"Default"}),i.jsx("option",{value:"products",children:"Products"}),i.jsx("option",{value:"subcategories",children:"Subcategories"}),i.jsx("option",{value:"both",children:"Both"})]})]}),(0,i.jsxs)("div",{className:"form-row",children:[i.jsx("label",{children:"Meta title"}),i.jsx("input",{name:"meta_title",value:u.meta_title,onChange:handleChange})]}),(0,i.jsxs)("div",{className:"form-row",children:[i.jsx("label",{children:"Meta description"}),i.jsx("input",{name:"meta_description",value:u.meta_description,onChange:handleChange})]}),(0,i.jsxs)("div",{className:"form-row",children:[i.jsx("label",{children:"Meta keywords"}),i.jsx("input",{name:"meta_keywords",value:u.meta_keywords,onChange:handleChange})]}),i.jsx("div",{className:"form-row",children:(0,i.jsxs)("label",{children:[i.jsx("input",{type:"checkbox",name:"isActive",checked:u.isActive,onChange:handleChange})," ","Active"]})}),(0,i.jsxs)("div",{style:{marginTop:16},children:[i.jsx("button",{className:"btn",type:"submit",disabled:v,children:v?"Saving…":"Save changes"}),i.jsx("button",{type:"button",className:"btn ghost",style:{marginLeft:8},onClick:()=>p(),children:"Refresh"})]})]}),(0,i.jsxs)("aside",{children:[(0,i.jsxs)("div",{className:"card",style:{marginBottom:12},children:[i.jsx("strong",{children:"Thumbnail"}),i.jsx("input",{type:"file",accept:"image/*",onChange:handleThumb,style:{marginTop:8}}),u.thumbnail_existing&&i.jsx("div",{style:{marginTop:8},children:i.jsx("img",{src:u.thumbnail_existing,alt:"thumb",style:{height:80,borderRadius:6}})})]}),(0,i.jsxs)("div",{className:"card",children:[i.jsx("strong",{children:"Images"}),i.jsx("input",{type:"file",accept:"image/*",multiple:!0,onChange:handleImages,style:{marginTop:8}}),u.images_existing?.length>0&&i.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:6,marginTop:8},children:u.images_existing.map((e,t)=>i.jsx("img",{src:e,alt:`img-${t}`,style:{height:60,borderRadius:6}},t))})]})]})]})})})]}):i.jsx(d.Z,{title:"Edit Category",children:i.jsx("div",{className:"card",children:"⏳ Loading…"})})}s()}catch(e){s(e)}})},2785:e=>{e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},6689:e=>{e.exports=require("react")},6405:e=>{e.exports=require("react-dom")},997:e=>{e.exports=require("react/jsx-runtime")},9816:e=>{e.exports=require("styled-jsx/style")},9648:e=>{e.exports=import("axios")},3590:e=>{e.exports=import("react-toastify")},5941:e=>{e.exports=import("swr")},7147:e=>{e.exports=require("fs")},1017:e=>{e.exports=require("path")},2781:e=>{e.exports=require("stream")},7310:e=>{e.exports=require("url")},9796:e=>{e.exports=require("zlib")}};var t=require("../../../../webpack-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),a=t.X(0,[761,544,994,450,345,597,142],()=>__webpack_exec__(7923));module.exports=a})();