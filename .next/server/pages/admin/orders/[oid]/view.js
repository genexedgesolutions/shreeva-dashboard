"use strict";(()=>{var e={};e.id=699,e.ids=[699,888,660],e.modules={9966:(e,r,s)=>{s.a(e,async(e,t)=>{try{s.r(r),s.d(r,{config:()=>u,default:()=>x,getServerSideProps:()=>m,getStaticPaths:()=>p,getStaticProps:()=>j,reportWebVitals:()=>g,routeModule:()=>b,unstable_getServerProps:()=>S,unstable_getServerSideProps:()=>P,unstable_getStaticParams:()=>f,unstable_getStaticPaths:()=>y,unstable_getStaticProps:()=>v});var i=s(7093),d=s(5244),a=s(1323),l=s(9209),n=s.n(l),c=s(9597),o=s(6717),h=e([c,o]);[c,o]=h.then?(await h)():h;let x=(0,a.l)(o,"default"),j=(0,a.l)(o,"getStaticProps"),p=(0,a.l)(o,"getStaticPaths"),m=(0,a.l)(o,"getServerSideProps"),u=(0,a.l)(o,"config"),g=(0,a.l)(o,"reportWebVitals"),v=(0,a.l)(o,"unstable_getStaticProps"),y=(0,a.l)(o,"unstable_getStaticPaths"),f=(0,a.l)(o,"unstable_getStaticParams"),S=(0,a.l)(o,"unstable_getServerProps"),P=(0,a.l)(o,"unstable_getServerSideProps"),b=new i.PagesRouteModule({definition:{kind:d.x.PAGES,page:"/admin/orders/[oid]/view",pathname:"/admin/orders/[oid]/view",bundlePath:"",filename:""},components:{App:c.default,Document:n()},userland:o});t()}catch(e){t(e)}})},6717:(e,r,s)=>{s.a(e,async(e,t)=>{try{s.r(r),s.d(r,{default:()=>OrderView});var i=s(997),d=s(1163),a=s(5941),l=s(1842),n=s(3142),c=s(1664),o=s.n(c),h=s(3692),x=s(3590),j=e([a,l,n,x]);[a,l,n,x]=j.then?(await j)():j;let fetcher=e=>l.Z.get(e,{params:{_t:Date.now()}});function OrderView(){let e=(0,d.useRouter)(),{oid:r}=e.query,{data:s,error:t,mutate:c}=(0,a.default)(r?`/order/order-details/${r}`:null,fetcher);if(t)return i.jsx(n.Z,{title:"Order",children:i.jsx("div",{className:"card",children:"❌ Error loading order"})});if(!s)return i.jsx(n.Z,{title:"Order",children:i.jsx("div",{className:"card",children:"⏳ Loading…"})});let j=s?.order||s,handleCancel=async()=>{if(confirm(`Cancel order ${j.orderId||r}? This cannot be undone.`))try{await l.Z.delete(`/order/cancel-order/${j.orderId||r}`),x.toast.success("Order cancelled"),c()}catch(e){console.error(e),x.toast.error(e?.message||"Failed to cancel order")}};return(0,i.jsxs)(n.Z,{title:`Order ${j.orderId||r}`,children:[(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[(0,i.jsxs)("h2",{children:["Order ",j.orderId||r]}),(0,i.jsxs)("div",{style:{display:"flex",gap:8},children:[i.jsx(o(),{href:`/admin/orders/${j.orderId||r}/edit`,legacyBehavior:!0,children:(0,i.jsxs)("a",{className:"btn",children:[i.jsx(h.vPQ,{})," Edit"]})}),(0,i.jsxs)("button",{className:"btn",onClick:handleCancel,style:{background:"#ef4444"},children:[i.jsx(h.Ybf,{})," Cancel Order"]})]})]}),(0,i.jsxs)("div",{className:"card",style:{marginBottom:12},children:[i.jsx("h4",{children:"Customer"}),(0,i.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8},children:[(0,i.jsxs)("div",{children:[i.jsx("strong",{children:"Name:"})," ",j.firstName," ",j.lastName]}),(0,i.jsxs)("div",{children:[i.jsx("strong",{children:"Email:"})," ",j.email]}),(0,i.jsxs)("div",{children:[i.jsx("strong",{children:"Phone:"})," ",j.phone]}),(0,i.jsxs)("div",{children:[i.jsx("strong",{children:"Order created:"})," ",j.createdAt?new Date(j.createdAt).toLocaleString():"-"]})]})]}),(0,i.jsxs)("div",{className:"card",style:{marginBottom:12},children:[i.jsx("h4",{children:"Shipping Address"}),j.address?(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{children:[j.address.street,", ",j.address.city]}),(0,i.jsxs)("div",{children:[j.address.state," — ",j.address.pincode]}),i.jsx("div",{children:j.address.country})]}):i.jsx("div",{className:"kv muted",children:"No address"})]}),(0,i.jsxs)("div",{className:"card",style:{marginBottom:12},children:[i.jsx("h4",{children:"Items"}),(0,i.jsxs)("table",{className:"table",children:[i.jsx("thead",{children:(0,i.jsxs)("tr",{children:[i.jsx("th",{children:"Product"}),i.jsx("th",{children:"Price"}),i.jsx("th",{children:"Qty"}),i.jsx("th",{children:"Subtotal"})]})}),i.jsx("tbody",{children:Array.isArray(j.cartProducts)&&j.cartProducts.length>0?j.cartProducts.map((e,r)=>(0,i.jsxs)("tr",{children:[i.jsx("td",{style:{maxWidth:300},children:(0,i.jsxs)("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[e.images?.[0]?i.jsx("img",{src:e.images[0],alt:e.name,className:"avatar"}):null,(0,i.jsxs)("div",{children:[i.jsx("div",{style:{fontWeight:700},children:e.name}),i.jsx("div",{className:"kv",children:e.shortDescription})]})]})}),(0,i.jsxs)("td",{children:["₹",e.price?.toFixed?.(2)??e.price]}),i.jsx("td",{children:e.quantity}),(0,i.jsxs)("td",{children:["₹",((e.price||0)*(e.quantity||0)).toFixed(2)]})]},r)):i.jsx("tr",{children:i.jsx("td",{colSpan:4,children:"No items"})})})]}),i.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:12,gap:12},children:(0,i.jsxs)("div",{className:"kv",children:[i.jsx("strong",{children:"Subtotal:"})," ₹",j.totalPrice?.toFixed?.(2)??j.totalPrice]})})]}),(0,i.jsxs)("div",{className:"card",style:{marginBottom:12},children:[i.jsx("h4",{children:"Payment & Shipping"}),(0,i.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8},children:[(0,i.jsxs)("div",{children:[i.jsx("strong",{children:"Payment Method:"})," ",j.paymentMethod]}),(0,i.jsxs)("div",{children:[i.jsx("strong",{children:"Payment Status:"})," ",j.paymentStatus]}),(0,i.jsxs)("div",{children:[i.jsx("strong",{children:"Selected Shipping:"})," ",j.selectedShippingOption?.name||JSON.stringify(j.selectedShippingOption)||"—"]}),(0,i.jsxs)("div",{children:[i.jsx("strong",{children:"Note:"})," ",j.note||"—"]})]})]}),(0,i.jsxs)("div",{className:"card",children:[i.jsx("h4",{children:"Status & History"}),(0,i.jsxs)("div",{style:{display:"flex",gap:18,alignItems:"flex-start"},children:[(0,i.jsxs)("div",{style:{minWidth:200},children:[i.jsx("div",{className:"kv",children:i.jsx("strong",{children:"Current:"})}),i.jsx("div",{style:{fontSize:18,fontWeight:700},children:j.orderStatus})]}),(0,i.jsxs)("div",{style:{flex:1},children:[i.jsx("div",{className:"kv",children:i.jsx("strong",{children:"History"})}),i.jsx("ul",{children:Array.isArray(j.statusHistory)&&j.statusHistory.length>0?j.statusHistory.map((e,r)=>(0,i.jsxs)("li",{children:[e.status," — ",e.updatedAt?new Date(e.updatedAt).toLocaleString():"-"]},r)):i.jsx("li",{className:"kv muted",children:"No history"})})]})]})]})]})}t()}catch(e){t(e)}})},2785:e=>{e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},6689:e=>{e.exports=require("react")},6405:e=>{e.exports=require("react-dom")},997:e=>{e.exports=require("react/jsx-runtime")},9816:e=>{e.exports=require("styled-jsx/style")},9648:e=>{e.exports=import("axios")},3590:e=>{e.exports=import("react-toastify")},5941:e=>{e.exports=import("swr")},7147:e=>{e.exports=require("fs")},1017:e=>{e.exports=require("path")},2781:e=>{e.exports=require("stream")},7310:e=>{e.exports=require("url")},9796:e=>{e.exports=require("zlib")}};var r=require("../../../../webpack-runtime.js");r.C(e);var __webpack_exec__=e=>r(r.s=e),s=r.X(0,[761,544,994,450,345,597,142],()=>__webpack_exec__(9966));module.exports=s})();