"use strict";(()=>{var e={};e.id=564,e.ids=[564,888,660],e.modules={725:(e,a,t)=>{t.a(e,async(e,r)=>{try{t.r(a),t.d(a,{config:()=>x,default:()=>u,getServerSideProps:()=>m,getStaticPaths:()=>h,getStaticProps:()=>g,reportWebVitals:()=>j,routeModule:()=>P,unstable_getServerProps:()=>b,unstable_getServerSideProps:()=>S,unstable_getStaticParams:()=>f,unstable_getStaticPaths:()=>v,unstable_getStaticProps:()=>y});var s=t(7093),i=t(5244),n=t(1323),l=t(9209),d=t.n(l),o=t(9597),c=t(4894),p=e([o,c]);[o,c]=p.then?(await p)():p;let u=(0,n.l)(c,"default"),g=(0,n.l)(c,"getStaticProps"),h=(0,n.l)(c,"getStaticPaths"),m=(0,n.l)(c,"getServerSideProps"),x=(0,n.l)(c,"config"),j=(0,n.l)(c,"reportWebVitals"),y=(0,n.l)(c,"unstable_getStaticProps"),v=(0,n.l)(c,"unstable_getStaticPaths"),f=(0,n.l)(c,"unstable_getStaticParams"),b=(0,n.l)(c,"unstable_getServerProps"),S=(0,n.l)(c,"unstable_getServerSideProps"),P=new s.PagesRouteModule({definition:{kind:i.x.PAGES,page:"/admin/products/[pid]/edit",pathname:"/admin/products/[pid]/edit",bundlePath:"",filename:""},components:{App:o.default,Document:d()},userland:c});r()}catch(e){r(e)}})},4894:(e,a,t)=>{t.a(e,async(e,r)=>{try{t.r(a),t.d(a,{default:()=>EditProduct});var s=t(997),i=t(1163),n=t(5941),l=t(1842),d=t(3142),o=t(6689),c=t(3590),p=t(1664),u=t.n(p),g=e([n,l,d,c]);[n,l,d,c]=g.then?(await g)():g;let fetchProduct=async e=>{try{let a=await l.Z.get(`/products/${e}`,{params:{_t:Date.now()}});return a?.product??a}catch(t){let a=await l.Z.get(`/products/slug/${e}`,{params:{_t:Date.now()}});return a?.product??a}};function EditProduct(){let e=(0,i.useRouter)(),{pid:a}=e.query,{data:t,error:r,mutate:p}=(0,n.default)(a?["product",a]:null,()=>fetchProduct(a)),[g,h]=(0,o.useState)(null),[m,x]=(0,o.useState)([]),[j,y]=(0,o.useState)([]),[v,f]=(0,o.useState)(!1),[b,S]=(0,o.useState)("");function handleChange(e){let{name:a,value:t,type:r,checked:s}=e.target;h(e=>({...e,[a]:"checkbox"===r?s:t}))}function handleImageSelect(e){x(Array.from(e.target.files||[]))}async function handleSave(a){if(a.preventDefault(),!g?.title){c.toast.error("Title required");return}f(!0);try{let a=new FormData;a.append("title",g.title),g.slug&&a.append("slug",g.slug),a.append("sku",g.sku),a.append("shortDescription",g.shortDescription),a.append("description",g.description),a.append("category",g.category),a.append("brand",g.brand),a.append("basePrice",String(g.basePrice||"0")),g.salePrice&&a.append("salePrice",String(g.salePrice)),a.append("productType",g.productType),a.append("isPublished",g.isPublished?"true":"false"),a.append("isMadeToOrder",g.isMadeToOrder?"true":"false"),a.append("leadTimeDays",String(g.leadTimeDays||0)),a.append("allowResizing",g.allowResizing?"true":"false"),a.append("allowEngraving",g.allowEngraving?"true":"false"),a.append("makingCharges",String(g.makingCharges||0)),a.append("stockQuantity",String(g.stockQuantity||0)),a.append("manageStock",g.manageStock?"true":"false"),g.weightGrams&&a.append("weightGrams",String(g.weightGrams)),a.append("metaTitle",g.metaTitle||""),a.append("metaDescription",g.metaDescription||""),a.append("featured",g.featured?"true":"false"),a.append("returnable",g.returnable?"true":"false"),a.append("warranty",g.warranty||""),b&&a.append("variants",b),m.forEach(e=>a.append("images",e));let t=await l.Z.put(`/products/${g._id}`,a,{headers:{"Content-Type":"multipart/form-data"}}),r=t?.data??t;r?.success||t?.success?(c.toast.success("Product updated"),p(),setTimeout(()=>e.push("/admin/products"),300)):c.toast.error(r?.message||"Update failed")}catch(e){console.error(e),c.toast.error(e?.response?.data?.message||e.message||"Error")}finally{f(!1)}}return((0,o.useEffect)(()=>{if(!t)return;let e=t?.product??t;h({title:e.title??e.post_title??e.name??"",slug:e.slug??e.post_name??"",sku:e.sku??"",shortDescription:e.shortDescription??"",description:e.description??e.post_content??"",category:e.category??"",brand:e.brand??"",basePrice:e.basePrice??e.price??e.regular_price??"",salePrice:e.salePrice??e.sale_price??"",productType:e.productType??"single",isPublished:"boolean"==typeof e.isPublished?e.isPublished:"publish"===e.post_status,isMadeToOrder:e.isMadeToOrder??!1,leadTimeDays:e.leadTimeDays??7,allowResizing:e.allowResizing??!0,allowEngraving:e.allowEngraving??!1,makingCharges:e.makingCharges??0,stockQuantity:e.stockQuantity??e.stockQuantity??0,manageStock:e.manageStock??!0,weightGrams:e.weightGrams??"",metaTitle:e.metaTitle??"",metaDescription:e.metaDescription??"",featured:!!e.featured,returnable:!!e.returnable,warranty:e.warranty??"",images_existing:e.images??[],variants:e.variants??[],_id:e._id??e.id}),e.variants&&S(JSON.stringify(e.variants,null,2))},[t]),(0,o.useEffect)(()=>{if(!m||0===m.length){y([]);return}let e=m.map(e=>URL.createObjectURL(e));return y(e),()=>{e.forEach(e=>URL.revokeObjectURL(e))}},[m]),r)?s.jsx(d.Z,{title:"Edit Product",children:s.jsx("div",{className:"card",children:"❌ Error loading product"})}):g?(0,s.jsxs)(d.Z,{title:`Edit Product: ${g.title}`,children:[(0,s.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:12},children:[s.jsx("h2",{children:"Edit Product"}),s.jsx(u(),{href:"/admin/products",legacyBehavior:!0,children:s.jsx("a",{className:"btn ghost",children:"Back"})})]}),s.jsx("form",{onSubmit:handleSave,children:s.jsx("div",{className:"card",style:{padding:20},children:(0,s.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 340px",gap:20},children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"form-row",children:[s.jsx("label",{children:"Title"}),s.jsx("input",{name:"title",value:g.title,onChange:handleChange})]}),(0,s.jsxs)("div",{className:"form-row",children:[s.jsx("label",{children:"Slug"}),s.jsx("input",{name:"slug",value:g.slug,onChange:handleChange})]}),(0,s.jsxs)("div",{className:"form-row",children:[s.jsx("label",{children:"SKU"}),s.jsx("input",{name:"sku",value:g.sku,onChange:handleChange})]}),(0,s.jsxs)("div",{className:"form-row",children:[s.jsx("label",{children:"Short description"}),s.jsx("input",{name:"shortDescription",value:g.shortDescription,onChange:handleChange})]}),(0,s.jsxs)("div",{className:"form-row",children:[s.jsx("label",{children:"Description"}),s.jsx("textarea",{name:"description",value:g.description,onChange:handleChange,rows:6})]}),(0,s.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8},children:[(0,s.jsxs)("div",{className:"form-row",children:[s.jsx("label",{children:"Base price"}),s.jsx("input",{type:"number",name:"basePrice",value:g.basePrice,onChange:handleChange})]}),(0,s.jsxs)("div",{className:"form-row",children:[s.jsx("label",{children:"Sale price"}),s.jsx("input",{type:"number",name:"salePrice",value:g.salePrice,onChange:handleChange})]})]}),(0,s.jsxs)("div",{className:"form-row",children:[s.jsx("label",{children:"Product type"}),(0,s.jsxs)("select",{name:"productType",value:g.productType,onChange:handleChange,children:[s.jsx("option",{value:"single",children:"Single"}),s.jsx("option",{value:"variant",children:"Variant"}),s.jsx("option",{value:"made-to-order",children:"Made To Order"})]})]}),(0,s.jsxs)("div",{className:"form-row",children:[s.jsx("label",{children:"Variants JSON (optional)"}),s.jsx("textarea",{value:b,onChange:e=>S(e.target.value),rows:4})]}),(0,s.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8},children:[(0,s.jsxs)("div",{className:"form-row",children:[s.jsx("label",{children:"Stock quantity"}),s.jsx("input",{type:"number",name:"stockQuantity",value:g.stockQuantity,onChange:handleChange})]}),(0,s.jsxs)("div",{className:"form-row",children:[s.jsx("label",{children:"Manage stock"}),(0,s.jsxs)("select",{name:"manageStock",value:String(g.manageStock),onChange:e=>h(a=>({...a,manageStock:"true"===e.target.value})),children:[s.jsx("option",{value:"true",children:"Yes"}),s.jsx("option",{value:"false",children:"No"})]})]})]}),(0,s.jsxs)("div",{className:"form-row",children:[s.jsx("label",{children:"Category (ID)"}),s.jsx("input",{name:"category",value:g.category,onChange:handleChange})]}),(0,s.jsxs)("div",{style:{marginTop:12},children:[s.jsx("button",{className:"btn",type:"submit",disabled:v,children:v?"Saving…":"Save changes"}),s.jsx("button",{type:"button",className:"btn ghost",style:{marginLeft:8},onClick:()=>p(),children:"Refresh"})]})]}),(0,s.jsxs)("aside",{children:[(0,s.jsxs)("div",{className:"card",style:{marginBottom:12},children:[s.jsx("strong",{children:"Images"}),s.jsx("input",{type:"file",accept:"image/*",multiple:!0,onChange:handleImageSelect,style:{marginTop:8}}),j.length>0?s.jsx("div",{style:{display:"flex",gap:8,flexWrap:"wrap",marginTop:8},children:j.map((e,a)=>s.jsx("img",{src:e,style:{height:80,borderRadius:6}},a))}):g.images_existing?.length?s.jsx("div",{style:{display:"flex",gap:8,flexWrap:"wrap",marginTop:8},children:g.images_existing.map((e,a)=>s.jsx("img",{src:e,style:{height:80,borderRadius:6}},a))}):null]}),(0,s.jsxs)("div",{className:"card",children:[s.jsx("strong",{children:"Summary"}),(0,s.jsxs)("div",{className:"kv",style:{marginTop:8},children:[(0,s.jsxs)("div",{children:[s.jsx("strong",{children:"Price:"})," ₹",g.basePrice," ",g.salePrice?`(sale ₹${g.salePrice})`:""]}),(0,s.jsxs)("div",{style:{marginTop:6},children:[s.jsx("strong",{children:"Stock:"})," ",g.stockQuantity]}),(0,s.jsxs)("div",{style:{marginTop:6},children:[s.jsx("strong",{children:"Type:"})," ",g.productType]}),(0,s.jsxs)("div",{style:{marginTop:6},children:[s.jsx("strong",{children:"Published:"})," ",g.isPublished?"Yes":"No"]})]})]})]})]})})})]}):s.jsx(d.Z,{title:"Edit Product",children:s.jsx("div",{className:"card",children:"⏳ Loading…"})})}r()}catch(e){r(e)}})},2785:e=>{e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},6689:e=>{e.exports=require("react")},6405:e=>{e.exports=require("react-dom")},997:e=>{e.exports=require("react/jsx-runtime")},9816:e=>{e.exports=require("styled-jsx/style")},9648:e=>{e.exports=import("axios")},3590:e=>{e.exports=import("react-toastify")},5941:e=>{e.exports=import("swr")},7147:e=>{e.exports=require("fs")},1017:e=>{e.exports=require("path")},2781:e=>{e.exports=require("stream")},7310:e=>{e.exports=require("url")},9796:e=>{e.exports=require("zlib")}};var a=require("../../../../webpack-runtime.js");a.C(e);var __webpack_exec__=e=>a(a.s=e),t=a.X(0,[761,544,994,450,345,597,142],()=>__webpack_exec__(725));module.exports=t})();